(executable
 (name discover)
 (libraries core stdio)
 (preprocess (pps ppx_let))
 (modules discover))

(rule
 (deps (file discover.exe))
 (targets config.ml)
 (action (with-stdout-to config.ml
          (run ./discover.exe -kind ML %{project_root} %{workspace_root}))))

(rule
 (deps (file discover.exe))
 (targets config)
 (mode promote)
 (action (with-stdout-to config
          (run ./discover.exe -kind ENV %{project_root} %{workspace_root}))))

; Local Variables:
; mode: tuareg-dune
; End:
