AHashIdx(Dedup(Select([f], r1)) as k, AList(Filter(f = k.f, r1) as lk, ascalar(lk.g)), 2)