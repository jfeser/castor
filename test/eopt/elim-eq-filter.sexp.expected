$3:
  select([a, b], ahashidx(dedup(select([a], atuple([ascalar(0 as a),
                                                    ascalar(0 as b)], cross))), $7, param0))
  filter((a = param0), atuple([ascalar(0 as a), ascalar(0 as b)], cross))
  
$4:
  select([a, b], ahashidx(dedup(select([a], atuple([ascalar(0 as a),
                                                    ascalar(0 as b)], cross))), $7, 0.x))
  filter((0.x = a), atuple([ascalar(0 as a), ascalar(0 as b)], cross))
  
$6:
  depjoin(ascalar(1 as x), $4)
  
$7:
  select([a, b], ahashidx(dedup(select([a], atuple([ascalar(0 as a),
                                                    ascalar(0 as b)], cross))), $7, 0.a))
  filter((a = 0.a), atuple([ascalar(0 as a), ascalar(0 as b)], cross))
  
