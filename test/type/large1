    alist(orderby([l_returnflag, l_linestatus], dedup(select([l_returnflag, l_linestatus], lineitem))) as k0,
                    select([l_returnflag, l_linestatus, sum(l_quantity) as sum_qty,
                            sum(l_extendedprice) as sum_base_price,
                            sum((l_extendedprice * (1 - l_discount))) as sum_disc_price,
                            sum(((l_extendedprice * (1 - l_discount)) * (1 + l_tax))) as sum_charge,
                            avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price,
                            avg(l_discount) as avg_disc, count() as count_order],
                      aorderedidx(dedup(select([l_shipdate], lineitem)) as s0,
                        select([l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus],
                          alist(select([l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus],
                                  filter(((l_returnflag = k0.l_returnflag) &&
                                         ((l_linestatus = k0.l_linestatus) && (l_shipdate = s0.l_shipdate))),
                                    lineitem)) as s1,
                            atuple([ascalar(s1.l_quantity), ascalar(s1.l_extendedprice),
                                    ascalar(s1.l_discount), ascalar(s1.l_tax),
                                    ascalar(s1.l_returnflag), ascalar(s1.l_linestatus)],
                              cross))),
                        , <= (date("1998-12-01") - day(param0)))))
