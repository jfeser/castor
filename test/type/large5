select([s1_acctbal, s1_name, n1_name, p1_partkey, p1_mfgr, s1_address,
           s1_phone, s1_comment],
     ahashidx(depjoin(select([min(p_size) as lo, max(p_size) as hi],
                        dedup(select([p_size], part))),
                select([range as k0], range(0.lo, 0.hi))),
       select([s1_acctbal, s1_name, n1_name, p1_partkey, p1_mfgr, s1_address,
               s1_phone, s1_comment],
         filter((((r1_name = "") &&
                 ((p1_size = 0.k0) &&
                 (strpos(p1_type, "") =
                 ((strlen(p1_type) - strlen("")) + 1)))) &&
                ((ps1_supplycost = min_cost) &&
                ((r1_name = r_name) && (ps_partkey = ps1_partkey)))),
           orderby([s1_acctbal desc, n1_name, s1_name, p1_partkey],
             join(true,
               alist(dedup(
                       select([r_name, ps_partkey],
                         join((s_suppkey = ps_suppkey),
                           join((s_nationkey = n_nationkey),
                             join((n_regionkey = r_regionkey), nation, region),
                             supplier),
                           partsupp))),
                 select([r_name, ps_partkey, min(ps_supplycost) as min_cost],
                   join((((r_name = 0.r_name) && (ps_partkey = 0.ps_partkey))
                        && (s_suppkey = ps_suppkey)),
                     join((s_nationkey = n_nationkey),
                       join((n_regionkey = r_regionkey),
                         alist(select([n_nationkey, n_regionkey], nation),
                           atuple([ascalar(0.n_nationkey),
                                   ascalar(0.n_regionkey)],
                             cross)),
                         alist(select([r_regionkey, r_name], region),
                           atuple([ascalar(0.r_regionkey), ascalar(0.r_name)],
                             cross))),
                       alist(select([s_suppkey, s_nationkey], supplier),
                         atuple([ascalar(0.s_suppkey),
                                 ascalar(0.s_nationkey)],
                           cross))),
                     alist(select([ps_partkey, ps_suppkey, ps_supplycost],
                             partsupp),
                       atuple([ascalar(0.ps_partkey), ascalar(0.ps_suppkey),
                               ascalar(0.ps_supplycost)],
                         cross))))),
               join((p1_partkey = ps1_partkey),
                 join((s1_suppkey = ps1_suppkey),
                   join((s1_nationkey = n1_nationkey),
                     join((n1_regionkey = r1_regionkey),
                       select([n_name as n1_name, n_nationkey as n1_nationkey,
                               n_regionkey as n1_regionkey],
                         alist(select([n_nationkey, n_name, n_regionkey], nation),
                           atuple([ascalar(0.n_nationkey),
                                   ascalar(0.n_name), ascalar(0.n_regionkey)],
                             cross))),
                       select([r_name as r1_name, r_regionkey as r1_regionkey],
                         alist(select([r_regionkey, r_name], region),
                           atuple([ascalar(0.r_regionkey), ascalar(0.r_name)], cross)))),
                     select([s_nationkey as s1_nationkey,
                             s_suppkey as s1_suppkey, s_acctbal as s1_acctbal,
                             s_name as s1_name, s_address as s1_address,
                             s_phone as s1_phone, s_comment as s1_comment],
                       alist(supplier,
                         atuple([ascalar(0.s_suppkey), ascalar(0.s_name),
                                 ascalar(0.s_address),
                                 ascalar(0.s_nationkey), ascalar(0.s_phone),
                                 ascalar(0.s_acctbal), ascalar(0.s_comment)],
                           cross)))),
                   select([ps_supplycost as ps1_supplycost,
                           ps_partkey as ps1_partkey, ps_suppkey as ps1_suppkey],
                     alist(select([ps_partkey, ps_suppkey, ps_supplycost],
                             partsupp),
                       atuple([ascalar(0.ps_partkey), ascalar(0.ps_suppkey),
                               ascalar(0.ps_supplycost)],
                         cross)))),
                 select([p_size as p1_size, p_type as p1_type,
                         p_partkey as p1_partkey, p_mfgr as p1_mfgr],
                   alist(select([p_partkey, p_mfgr, p_type, p_size], part),
                     atuple([ascalar(0.p_partkey), ascalar(0.p_mfgr),
                             ascalar(0.p_type), ascalar(0.p_size)],
                       cross)))))))),
       0))
