(jbuild_version 1)

(install
 ((section bin)
  (files (compile.exe transform.exe inspect.exe pretty.exe))))

(rule
 ((targets (config.ml))
  (deps    (../config))
  (action  (copy ${<} ${@}))))

(executable
 ((name inspect)
  (libraries (core async dblayout))
  (flags (:standard -g -bin-annot))
  (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
  (modules (inspect util))))

(executable
 ((name pretty)
  (libraries (core dblayout))
  (flags (:standard -g -bin-annot))
  (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
  (modules (pretty))))


; (executable
;  ((name search)
;   (libraries (core async postgresql dblayout))
;   (flags (:standard -g -bin-annot))
;   (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
;   (modules search)))

(executable
 ((name compile)
  (libraries (core async dblayout))
  (flags (:standard -g -bin-annot))
  (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
  (modules (compile config))))

(executable
 ((name transform)
  (libraries (core postgresql dblayout logs))
  (flags (:standard -g -bin-annot))
  (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
  (modules transform)))
