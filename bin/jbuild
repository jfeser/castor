(jbuild_version 1)

(install
 ((section bin)
  (files (compile.exe search.exe transform.exe))))

(rule
 ((targets (config.ml))
  (deps    (../config))
  (action  (copy ${<} ${@}))))

(executable
 ((name search)
  (libraries (core postgresql dblayout))
  (flags (:standard -g -bin-annot))
  (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
  (modules search)))

(executable
 ((name compile)
  (libraries (core dblayout))
  (flags (:standard -g -bin-annot))
  (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
  (modules (compile config))))

(executable
 ((name transform)
  (libraries (core postgresql dblayout logs))
  (flags (:standard -g -bin-annot))
  (preprocess (pps (ppx_sexp_conv ppx_let ppx_driver.runner -no-check)))
  (modules transform)))
