atuple([
    ahashidx(
      dedup(select([o_orderdate as d], orders)),
      alist(groupby([o_custkey as custkey, sum(l_extendedprice * (1 - l_discount)) as revenue],
                    [o_custkey],
                    join(o_orderkey = l_orderkey,
                         filter(l_returnflag = "R", lineitem),
                         filter(o_orderdate >= d && o_orderdate < d + month(3), orders))),
            atuple([ascalar(custkey), ascalar(revenue)], cross)),
      param0),
        ahashidx(dedup(select([c_custkey as k], customer)),
                 alist(join((c_nationkey = n_nationkey),
                            filter((c_custkey = k), customer),
                            nation),
                       atuple([ascalar(c_custkey),
                               ascalar(c_name),
                               ascalar(c_acctbal),
                               ascalar(n_name),
                               ascalar(c_address),
                               ascalar(c_phone),
                               ascalar(c_comment)
                              ], cross)),
                 custkey)
  ], cross)
