select([customer.c_custkey,
        customer.c_name,
        revenue,
        customer.c_acctbal,
        nation.n_name,
        customer.c_address,
        customer.c_phone,
        customer.c_comment],
  atuple([select([customer.c_custkey, revenue, nation.n_name],
            ahashidx(dedup(select([orders.o_orderdate as param0_0], orders)),
              alist(groupby([customer.c_custkey,
                             customer.c_name,
                             sum((lineitem.l_extendedprice *
                                 (1 - lineitem.l_discount))) as revenue,
                             customer.c_acctbal,
                             nation.n_name,
                             customer.c_address,
                             customer.c_phone,
                             customer.c_comment],
                      [customer.c_custkey,
                       customer.c_name,
                       customer.c_acctbal,
                       customer.c_phone,
                       nation.n_name,
                       customer.c_address,
                       customer.c_comment],
                      join((customer.c_custkey = orders.o_custkey),
                        join((customer.c_nationkey = nation.n_nationkey),
                          customer,
                          nation),
                        join((lineitem.l_orderkey = orders.o_orderkey),
                          filter((lineitem.l_returnflag = "R"), lineitem),
                          filter(((orders.o_orderdate >= param0_0) &&
                                 (orders.o_orderdate < (param0_0 + month(3)))),
                            orders)))),
                atuple([ascalar(customer.c_custkey),
                        ascalar(revenue),
                        ascalar(nation.n_name)],
                  cross)),
              param0)),
          ahashidx(dedup(
                     select([customer_3.c_custkey], customer as customer_3)),
            alist(select([customer_4.c_name,
                          customer_4.c_acctbal,
                          customer_4.c_address,
                          customer_4.c_phone,
                          customer_4.c_comment],
                    filter((customer_4.c_custkey = customer_3.c_custkey),
                      customer as customer_4)),
              atuple([ascalar(customer_4.c_name),
                      ascalar(customer_4.c_acctbal),
                      ascalar(customer_4.c_address),
                      ascalar(customer_4.c_phone),
                      ascalar(customer_4.c_comment)],
                cross)),
            customer.c_custkey) as customer],
    cross))