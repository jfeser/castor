alist(orderby([k0_orders_o_orderpriority],
        dedup(
          select([orders.o_orderpriority as k0_orders_o_orderpriority], orders)),
        asc),
  select([orders.o_orderpriority, count() as order_count],
    filter(((orders.o_orderdate >= param1) &&
           ((orders.o_orderdate < (param1 + month(3))) &&
           exists(filter((lineitem.l_commitdate < lineitem.l_receiptdate),
                    ahashidx(dedup(
                               select([lineitem.l_orderkey as k3], lineitem)),
                      alist(filter((k3 = lineitem.l_orderkey), lineitem),
                        atuple([ascalar(lineitem.l_commitdate),
                                ascalar(lineitem.l_receiptdate)],
                          cross)),
                      orders.o_orderkey))))),
      alist(filter((orders.o_orderpriority = k0_orders_o_orderpriority),
              orders),
        atuple([ascalar(orders.o_orderkey),
                ascalar(orders.o_orderdate),
                ascalar(orders.o_orderpriority)],
          cross)))))