select([(sum(lineitem.l_extendedprice) / 7.0) as avg_yearly],
  filter((lineitem.l_quantity <
         (select([l_avgquantity],
            ahashidx(dedup(select([lineitem.l_partkey as k2], lineitem)),
              alist(select([(0.2 * avg(lineitem.l_quantity)) as l_avgquantity],
                      filter((k2 = lineitem.l_partkey), lineitem)),
                atuple([ascalar(l_avgquantity)], cross)),
              part.p_partkey)))),
    ahashidx(dedup(
               select([part.p_brand as k3, part.p_container as k4],
                 join((part.p_partkey = lineitem.l_partkey), lineitem, part))),
      alist(filter(((k3 = part.p_brand) && (k4 = part.p_container)),
              join((part.p_partkey = lineitem.l_partkey), lineitem, part)),
        atuple([ascalar(lineitem.l_quantity),
                ascalar(lineitem.l_extendedprice),
                ascalar(part.p_partkey)],
          cross)),
      (param0, param1))))
