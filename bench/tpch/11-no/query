filter((value >
       (select([(sum((partsupp.ps_supplycost * partsupp.ps_availqty)) * param2) as v],
          filter((nation.n_name = param1),
            alist(join((partsupp.ps_suppkey = supplier.s_suppkey),
                    join((supplier.s_nationkey = nation.n_nationkey),
                      supplier,
                      nation),
                    partsupp),
              atuple([ascalar(nation.n_name),
                      ascalar(partsupp.ps_availqty),
                      ascalar(partsupp.ps_supplycost)],
                cross)))))),
  alist(dedup(
          select([partsupp.ps_partkey as k0_partsupp_ps_partkey],
            join((partsupp.ps_suppkey = supplier.s_suppkey),
              join((supplier.s_nationkey = nation.n_nationkey),
                supplier,
                nation),
              partsupp))),
    select([partsupp.ps_partkey,
            sum((partsupp.ps_supplycost * partsupp.ps_availqty)) as value],
      filter((nation.n_name = param1),
        alist(filter((partsupp.ps_partkey = k0_partsupp_ps_partkey),
                join((partsupp.ps_suppkey = supplier.s_suppkey),
                  join((supplier.s_nationkey = nation.n_nationkey),
                    supplier,
                    nation),
                  partsupp)),
          atuple([ascalar(nation.n_name),
                  ascalar(partsupp.ps_partkey),
                  ascalar(partsupp.ps_availqty),
                  ascalar(partsupp.ps_supplycost)],
            cross))))))