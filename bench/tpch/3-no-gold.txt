select([l_orderkey, revenue, o_orderdate, o_shippriority],
  ahashidx(dedup(select([c_mktsegment as customer_c_mktsegment_0], customer)) as s2,
    alist(dedup(
            select([l_orderkey as k0_l_orderkey,
                    o_orderdate as k0_o_orderdate,
                    o_shippriority as k0_o_shippriority],
              join((l_orderkey = o_orderkey), orders, lineitem))) as s0,
      select([l_orderkey,
              sum((l_extendedprice * (1 - l_discount))) as revenue,
              o_orderdate,
              o_shippriority],
        filter((o_orderdate < param1),
          filter((l_shipdate > param1),
            alist(select([o_orderdate,
                          o_shippriority,
                          l_orderkey,
                          l_extendedprice,
                          l_discount,
                          l_shipdate],
                    filter((c_mktsegment = s2.customer_c_mktsegment_0),
                      filter((((l_orderkey = s0.k0_l_orderkey) &&
                              (o_orderdate = s0.k0_o_orderdate)) &&
                             (o_shippriority = s0.k0_o_shippriority)),
                        join((c_custkey = o_custkey),
                          join((l_orderkey = o_orderkey), orders, lineitem),
                          filter((c_mktsegment = s2.customer_c_mktsegment_0),
                            customer))))) as s13,
              atuple([ascalar(s13.o_orderdate),
                      ascalar(s13.o_shippriority),
                      ascalar(s13.l_orderkey),
                      ascalar(s13.l_extendedprice),
                      ascalar(s13.l_discount),
                      ascalar(s13.l_shipdate)],
                cross)))))),
    param0))