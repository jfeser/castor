select([k1_lineitem_l_orderkey, revenue, k1_orders_o_orderdate, k1_orders_o_shippriority],
ahashidx(dedup(
           select([customer.c_mktsegment as customer_c_mktsegment_0], customer)),
  alist(dedup(
          select([lineitem.l_orderkey as k1_lineitem_l_orderkey,
                  orders.o_orderdate as k1_orders_o_orderdate,
                  orders.o_shippriority as k1_orders_o_shippriority],
            join((customer.c_custkey = orders.o_custkey),
              join((lineitem.l_orderkey = orders.o_orderkey), orders, lineitem),
              filter((customer.c_mktsegment = customer_c_mktsegment_0),
                customer)))),
    select([k1_lineitem_l_orderkey,
            sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue,
            k1_orders_o_orderdate,
            k1_orders_o_shippriority],
      filter(((k1_orders_o_orderdate < param1) && (lineitem.l_shipdate > param1)),
        alist(filter(lineitem.l_orderkey = k1_lineitem_l_orderkey, lineitem),
          atuple([ascalar(k1_orders_o_orderdate),
                  ascalar(k1_orders_o_shippriority),
                  ascalar(k1_lineitem_l_orderkey),
                  ascalar(lineitem.l_extendedprice),
                  ascalar(lineitem.l_discount),
                  ascalar(lineitem.l_shipdate)],
            cross))))),
  param0))
