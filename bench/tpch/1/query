alist(orderby([k0_lineitem_l_returnflag, k0_lineitem_l_linestatus],
        dedup(
          select([lineitem.l_returnflag as k0_lineitem_l_returnflag,
                  lineitem.l_linestatus as k0_lineitem_l_linestatus],
            lineitem)),
        asc),
  select([lineitem.l_returnflag,
          lineitem.l_linestatus,
          sum(lineitem.l_quantity) as sum_qty,
          sum(lineitem.l_extendedprice) as sum_base_price,
          sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as sum_disc_price,
          sum(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) *
              (1 + lineitem.l_tax))) as sum_charge,
          avg(lineitem.l_quantity) as avg_qty,
          avg(lineitem.l_extendedprice) as avg_price,
          avg(lineitem.l_discount) as avg_disc,
          count() as count_order],
    filter((lineitem.l_shipdate <= (date("1998-12-01") - day(param0))),
      alist(filter(((lineitem.l_returnflag = k0_lineitem_l_returnflag) &&
                   (lineitem.l_linestatus = k0_lineitem_l_linestatus)),
              lineitem),
        atuple([ascalar(lineitem.l_quantity),
                ascalar(lineitem.l_extendedprice),
                ascalar(lineitem.l_discount),
                ascalar(lineitem.l_tax),
                ascalar(lineitem.l_returnflag),
                ascalar(lineitem.l_linestatus),
                ascalar(lineitem.l_shipdate)],
          cross)))))