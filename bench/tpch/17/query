select([(sum(lineitem.l_extendedprice) / 7.0) as avg_yearly],
  filter((lineitem.l_quantity <
         (select([(0.2 * avg(lineitem.l_quantity)) as l_avgquantity],
            filter((lineitem.l_partkey = part.p_partkey),
              alist(lineitem,
                atuple([ascalar(lineitem.l_partkey),
                        ascalar(lineitem.l_quantity)],
                  cross)))))),
    filter(((part.p_brand = param0) && (part.p_container = param1)),
      alist(join((part.p_partkey = lineitem.l_partkey), lineitem, part),
        atuple([ascalar(lineitem.l_orderkey),
                ascalar(lineitem.l_partkey),
                ascalar(lineitem.l_suppkey),
                ascalar(lineitem.l_linenumber),
                ascalar(lineitem.l_quantity),
                ascalar(lineitem.l_extendedprice),
                ascalar(lineitem.l_discount),
                ascalar(lineitem.l_tax),
                ascalar(lineitem.l_returnflag),
                ascalar(lineitem.l_linestatus),
                ascalar(lineitem.l_shipdate),
                ascalar(lineitem.l_commitdate),
                ascalar(lineitem.l_receiptdate),
                ascalar(lineitem.l_shipinstruct),
                ascalar(lineitem.l_shipmode),
                ascalar(lineitem.l_comment),
                ascalar(part.p_partkey),
                ascalar(part.p_brand),
                ascalar(part.p_container)],
          cross)))))