alist(dedup(
        select([lineitem.l_orderkey as k0_lineitem_l_orderkey,
                orders.o_orderdate as k0_orders_o_orderdate,
                orders.o_shippriority as k0_orders_o_shippriority],
          join((customer.c_custkey = orders.o_custkey),
            join((lineitem.l_orderkey = orders.o_orderkey), orders, lineitem),
            customer))),
  select([lineitem.l_orderkey,
          sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue,
          orders.o_orderdate,
          orders.o_shippriority],
    filter(((customer.c_mktsegment = param0) &&
           ((orders.o_orderdate < param1) && (lineitem.l_shipdate > param1))),
      alist(filter((((lineitem.l_orderkey = k0_lineitem_l_orderkey) &&
                    (orders.o_orderdate = k0_orders_o_orderdate)) &&
                   (orders.o_shippriority = k0_orders_o_shippriority)),
              join((customer.c_custkey = orders.o_custkey),
                join((lineitem.l_orderkey = orders.o_orderkey),
                  orders,
                  lineitem),
                customer)),
        atuple([ascalar(orders.o_orderdate),
                ascalar(orders.o_shippriority),
                ascalar(lineitem.l_orderkey),
                ascalar(lineitem.l_extendedprice),
                ascalar(lineitem.l_discount),
                ascalar(lineitem.l_shipdate),
                ascalar(customer.c_mktsegment)],
          cross)))))