alist(orderby([k0_orders_o_totalprice, k0_orders_o_orderdate],
        dedup(
          select([customer.c_name as k0_customer_c_name,
                  customer.c_custkey as k0_customer_c_custkey,
                  orders.o_orderkey as k0_orders_o_orderkey,
                  orders.o_orderdate as k0_orders_o_orderdate,
                  orders.o_totalprice as k0_orders_o_totalprice],
            join((customer.c_custkey = orders.o_custkey),
              join((orders.o_orderkey = lineitem.l_orderkey), orders, lineitem),
              customer))),
        desc),
  select([customer.c_name,
          customer.c_custkey,
          orders.o_orderkey,
          orders.o_orderdate,
          orders.o_totalprice,
          sum(lineitem.l_quantity)],
    filter(exists(filter(((orders.o_orderkey = lineitem.l_orderkey) &&
                         (sum_l_quantity > param1)),
                    alist(groupby([lineitem.l_orderkey,
                                   sum(lineitem.l_quantity) as sum_l_quantity],
                            [lineitem.l_orderkey],
                            lineitem),
                      atuple([ascalar(lineitem.l_orderkey),
                              ascalar(sum_l_quantity)],
                        cross)))),
      alist(filter((((((customer.c_name = k0_customer_c_name) &&
                      (customer.c_custkey = k0_customer_c_custkey)) &&
                     (orders.o_orderkey = k0_orders_o_orderkey)) &&
                    (orders.o_orderdate = k0_orders_o_orderdate)) &&
                   (orders.o_totalprice = k0_orders_o_totalprice)),
              join((customer.c_custkey = orders.o_custkey),
                join((orders.o_orderkey = lineitem.l_orderkey),
                  orders,
                  lineitem),
                customer)),
        atuple([ascalar(orders.o_orderkey),
                ascalar(orders.o_totalprice),
                ascalar(orders.o_orderdate),
                ascalar(lineitem.l_orderkey),
                ascalar(lineitem.l_quantity),
                ascalar(customer.c_custkey),
                ascalar(customer.c_name)],
          cross)))))