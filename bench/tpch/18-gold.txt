filter(exists(filter((sum_l_quantity > param1),
                ahashidx(dedup(
                           select([l_orderkey as k1],
                             groupby([l_orderkey,
                                      sum(l_quantity) as sum_l_quantity],
                               [l_orderkey],
                               lineitem))) as s1,
                  alist(filter((s1.k1 = l_orderkey),
                          groupby([l_orderkey,
                                   sum(l_quantity) as sum_l_quantity],
                            [l_orderkey],
                            lineitem)) as s2,
                    atuple([ascalar(s2.sum_l_quantity)], cross)),
                  o_orderkey))),
  alist(orderby([o_totalprice desc, o_orderdate],
          groupby([c_name,
                   c_custkey,
                   o_orderkey,
                   o_orderdate,
                   o_totalprice,
                   sum(l_quantity) as tot_quantity],
            [c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice],
            join((c_custkey = o_custkey),
              join((o_orderkey = l_orderkey), orders, lineitem),
              customer))) as s3,
    atuple([ascalar(s3.c_name),
            ascalar(s3.c_custkey),
            ascalar(s3.o_orderkey),
            ascalar(s3.o_orderdate),
            ascalar(s3.o_totalprice),
            ascalar(s3.tot_quantity)],
      cross)))