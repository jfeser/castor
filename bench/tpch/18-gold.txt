filter(exists(filter((sum_l_quantity > param1),
                ahashidx(dedup(
                           select([lineitem.l_orderkey as k1],
                             groupby([lineitem.l_orderkey,
                                      sum(lineitem.l_quantity) as sum_l_quantity],
                               [lineitem.l_orderkey],
                               lineitem))),
                  alist(filter((k1 = lineitem.l_orderkey),
                          groupby([lineitem.l_orderkey,
                                   sum(lineitem.l_quantity) as sum_l_quantity],
                            [lineitem.l_orderkey],
                            lineitem)),
                    atuple([ascalar(sum_l_quantity)], cross)),
                  orders.o_orderkey))),
  alist(orderby([orders.o_totalprice desc, orders.o_orderdate],
          groupby([customer.c_name,
                   customer.c_custkey,
                   orders.o_orderkey,
                   orders.o_orderdate,
                   orders.o_totalprice,
                   sum(lineitem.l_quantity)],
            [customer.c_name,
             customer.c_custkey,
             orders.o_orderkey,
             orders.o_orderdate,
             orders.o_totalprice],
            join((customer.c_custkey = orders.o_custkey),
              join((orders.o_orderkey = lineitem.l_orderkey), orders, lineitem),
              customer))),
    atuple([ascalar(customer.c_name),
            ascalar(customer.c_custkey),
            ascalar(orders.o_orderkey),
            ascalar(orders.o_orderdate),
            ascalar(orders.o_totalprice),
            ascalar(lineitem.l_quantity)],
      cross)))