ahashidx(dedup(select([region.r_name as region_r_name_0], region)),
  select([supplier.s_acctbal,
          supplier.s_name,
          nation.n_name,
          part.p_partkey,
          part.p_mfgr,
          supplier.s_address,
          supplier.s_phone,
          supplier.s_comment],
    atuple([select([nation.n_name,
                    supplier.s_suppkey,
                    part.p_partkey,
                    part.p_mfgr],
              filter(((part.p_size = param1) &&
                     (strpos(part.p_type, param2) =
                     (strlen(part.p_type) - strlen(param2)))),
                alist(orderby([supplier.s_acctbal,
                               nation.n_name,
                               supplier.s_name,
                               part.p_partkey],
                        filter((partsupp.ps_supplycost =
                               (select([min(partsupp.ps_supplycost)],
                                  join((part.p_partkey = partsupp.ps_partkey),
                                    join((supplier.s_suppkey =
                                         partsupp.ps_suppkey),
                                      join((supplier.s_nationkey =
                                           nation.n_nationkey),
                                        join((nation.n_nationkey =
                                             region.r_regionkey),
                                          nation,
                                          filter((region.r_name =
                                                 region_r_name_0),
                                            filter((region.r_name =
                                                   region_r_name_0),
                                              region))),
                                        supplier),
                                      partsupp),
                                    part)))),
                          join((part.p_partkey = partsupp.ps_partkey),
                            filter((region.r_name = region_r_name_0),
                              join((supplier.s_suppkey = partsupp.ps_suppkey),
                                join((supplier.s_nationkey =
                                     nation.n_nationkey),
                                  join((nation.n_regionkey =
                                       region.r_regionkey),
                                    nation,
                                    filter((region.r_name = region_r_name_0),
                                      region)),
                                  supplier),
                                partsupp)),
                            part)),
                        desc),
                  atuple([ascalar(nation.n_name),
                          ascalar(supplier.s_suppkey),
                          ascalar(part.p_partkey),
                          ascalar(part.p_mfgr),
                          ascalar(part.p_type),
                          ascalar(part.p_size)],
                    cross)))),
            ahashidx(dedup(
                       select([supplier.s_suppkey as supplier_s_suppkey_1],
                         supplier)),
              alist(filter((supplier.s_suppkey = supplier_s_suppkey_1),
                      supplier),
                atuple([ascalar(supplier.s_name),
                        ascalar(supplier.s_address),
                        ascalar(supplier.s_phone),
                        ascalar(supplier.s_acctbal),
                        ascalar(supplier.s_comment)],
                  cross)),
              supplier.s_suppkey)],
      cross)),
  param3)
