orderby([revenue, o_orderdate], groupby([l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority],
  [l_orderkey, o_orderdate, o_shippriority],
  join(c_custkey = o_custkey,
  join(l_orderkey = o_orderkey,
  filter(o_orderdate < param1, orders),
  filter(l_shipdate > param1, lineitem)),
  filter(c_mktsegment=param0, customer))), asc)
