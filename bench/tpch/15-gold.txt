select([s_suppkey, s_name, s_address, s_phone, total_revenue],
ahashidx(dedup(select([lineitem.l_shipdate as param1_0], lineitem)),
  alist(orderby([supplier.s_suppkey],
          select([supplier.s_suppkey,
                  supplier.s_name,
                  supplier.s_address,
                  supplier.s_phone,
                  total_revenue],
            join((total_revenue = max_total_revenue),
            join(((supplier.s_suppkey = supplier_no)),
              supplier,
              groupby([lineitem.l_suppkey as supplier_no,
                       sum((lineitem.l_extendedprice *
                           (1 - lineitem.l_discount))) as total_revenue],
                [lineitem.l_suppkey],
                filter(((lineitem.l_shipdate >= param1_0) &&
                       (lineitem.l_shipdate < (param1_0 + month(3)))),
                  lineitem))),
                  select([max(total_revenue_i) as max_total_revenue],
                    groupby([lineitem.l_suppkey as supplier_no,
                             sum((lineitem.l_extendedprice *
                                 (1 - lineitem.l_discount))) as total_revenue_i],
                      [lineitem.l_suppkey],
                      filter(((lineitem.l_shipdate >= param1_0) &&
                             (lineitem.l_shipdate < (param1_0 + month(3)))),
                        lineitem))))),
          desc),
    atuple([ascalar(supplier.s_suppkey),
            ascalar(supplier.s_name),
            ascalar(supplier.s_address),
            ascalar(supplier.s_phone),
            ascalar(total_revenue)],
      cross)),
  param1))
