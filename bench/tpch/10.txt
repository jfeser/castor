orderby([revenue desc],
  groupby([c_custkey,
           c_name,
           sum(l_extendedprice * 1 - l_discount) as revenue,
           c_acctbal,
           n_name,
           c_address,
           c_phone,
           c_comment],
    [c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment],
    join(c_custkey = o_custkey,
      join(c_nationkey = n_nationkey, customer, nation),
      join(l_orderkey = o_orderkey,
        filter(l_returnflag = "R", lineitem),
        filter(o_orderdate >= param0 && o_orderdate < param0 + month(3), orders)))))
