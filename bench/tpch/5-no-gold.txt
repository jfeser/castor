ahashidx(dedup(select([region.r_name as region_r_name_0], region)),
  alist(dedup(select([nation.n_name as n_namek1], nation)),
    select([nation.n_name, sum(agg3) as revenue],
      aorderedidx(dedup(
                    select([orders.o_orderdate as k2],
                      filter((region.r_name = region_r_name_0),
                        join((lineitem.l_orderkey = orders.o_orderkey),
                          join((customer.c_custkey = orders.o_custkey),
                            join((customer.c_nationkey = supplier.s_nationkey),
                              join((supplier.s_nationkey = nation.n_nationkey),
                                join((nation.n_regionkey = region.r_regionkey),
                                  filter((region.r_name = region_r_name_0),
                                    region),
                                  filter((nation.n_name = n_namek1), nation)),
                                supplier),
                              customer),
                            orders),
                          lineitem)))),
        alist(select([sum((lineitem.l_extendedprice *
                          (1 - lineitem.l_discount))) as agg3,
                      nation.n_name],
                filter((k2 = orders.o_orderdate),
                  filter((region.r_name = region_r_name_0),
                    join((lineitem.l_orderkey = orders.o_orderkey),
                      join((customer.c_custkey = orders.o_custkey),
                        join((customer.c_nationkey = supplier.s_nationkey),
                          join((supplier.s_nationkey = nation.n_nationkey),
                            join((nation.n_regionkey = region.r_regionkey),
                              filter((region.r_name = region_r_name_0), region),
                              filter((nation.n_name = n_namek1), nation)),
                            supplier),
                          customer),
                        orders),
                      lineitem)))),
          atuple([ascalar(agg3), ascalar(nation.n_name)], cross)),
        param1,
        (param1 + year(1))))),
  param0)