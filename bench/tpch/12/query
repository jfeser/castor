alist(orderby([k0_lineitem_l_shipmode],
        dedup(
          select([lineitem.l_shipmode as k0_lineitem_l_shipmode],
            join((orders.o_orderkey = lineitem.l_orderkey), orders, lineitem))),
        asc),
  select([lineitem.l_shipmode,
          sum(if ((orders.o_orderpriority = "1-URGENT") ||
                 (orders.o_orderpriority = "2-HIGH")) then 1 else 0) as high_line_count,
          sum(if (not((orders.o_orderpriority = "1-URGENT")) &&
                 not((orders.o_orderpriority = "2-HIGH"))) then 1 else 0) as low_line_count],
    filter((((lineitem.l_shipmode = param1) || (lineitem.l_shipmode = param2))
           &&
           ((lineitem.l_commitdate < lineitem.l_receiptdate) &&
           ((lineitem.l_shipdate < lineitem.l_commitdate) &&
           ((lineitem.l_receiptdate >= param3) &&
           (lineitem.l_receiptdate < (param3 + year(1))))))),
      alist(filter((lineitem.l_shipmode = k0_lineitem_l_shipmode),
              join((orders.o_orderkey = lineitem.l_orderkey), orders, lineitem)),
        atuple([ascalar(orders.o_orderpriority),
                ascalar(lineitem.l_shipdate),
                ascalar(lineitem.l_commitdate),
                ascalar(lineitem.l_receiptdate),
                ascalar(lineitem.l_shipmode)],
          cross)))))