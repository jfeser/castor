alist(dedup(
        select([nation.n_name as k0_nation_n_name],
          join((lineitem.l_orderkey = orders.o_orderkey),
            join((customer.c_custkey = orders.o_custkey),
              join((customer.c_nationkey = supplier.s_nationkey),
                join((supplier.s_nationkey = nation.n_nationkey),
                  join((nation.n_regionkey = region.r_regionkey),
                    region,
                    nation),
                  supplier),
                customer),
              orders),
            lineitem))),
  select([nation.n_name,
          sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue],
    filter((((orders.o_orderdate >= param1) &&
            (orders.o_orderdate < (param1 + year(1)))) &&
           (region.r_name = param0)),
      alist(filter((nation.n_name = k0_nation_n_name),
              join((lineitem.l_orderkey = orders.o_orderkey),
                join((customer.c_custkey = orders.o_custkey),
                  join((customer.c_nationkey = supplier.s_nationkey),
                    join((supplier.s_nationkey = nation.n_nationkey),
                      join((nation.n_regionkey = region.r_regionkey),
                        region,
                        nation),
                      supplier),
                    customer),
                  orders),
                lineitem)),
        atuple([ascalar(region.r_name),
                ascalar(nation.n_name),
                ascalar(orders.o_orderdate),
                ascalar(lineitem.l_extendedprice),
                ascalar(lineitem.l_discount)],
          cross)))))