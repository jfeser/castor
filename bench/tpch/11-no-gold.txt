select([ps_partkey, value],
  ahashidx(dedup(select([nation.n_name as nation_n_name_0], nation)),
    atuple([select([(const33 * param2) as const3],
              ascalar((select([sum((partsupp.ps_supplycost *
                                   partsupp.ps_availqty))],
                         filter((nation.n_name = nation_n_name_0),
                           join((partsupp.ps_suppkey = supplier.s_suppkey),
                             join((supplier.s_nationkey = nation.n_nationkey),
                               supplier,
                               filter((nation.n_name = nation_n_name_0), nation)),
                             partsupp)))) as const33)),
            filter((value > const3),
              alist(dedup(
                      select([partsupp.ps_partkey as k1_partsupp_ps_partkey],
                        join((partsupp.ps_suppkey = supplier.s_suppkey),
                          join((supplier.s_nationkey = nation.n_nationkey),
                            supplier,
                            filter((nation.n_name = nation_n_name_0), nation)),
                          partsupp))),
                alist(select([partsupp.ps_partkey,
                              sum((partsupp.ps_supplycost * partsupp.ps_availqty)) as value],
                        filter((nation.n_name = nation_n_name_0),
                          filter((partsupp.ps_partkey = k1_partsupp_ps_partkey),
                            join((partsupp.ps_suppkey = supplier.s_suppkey),
                              join((supplier.s_nationkey = nation.n_nationkey),
                                supplier,
                                filter((nation.n_name = nation_n_name_0), nation)),
                              partsupp)))),
                  atuple([ascalar(partsupp.ps_partkey), ascalar(value)], cross))))],
      cross),
    param1))
