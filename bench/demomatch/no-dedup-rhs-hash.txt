select([lp.counter],
        join(lp.counter < lc.counter && lc.counter < lp.succ,
          filter(t.id = id_p,
            alist(log_bench as t,
              atuple([ascalar(t.counter),
                      ascalar(t.event_type),
                      ascalar(t.id),
                      ascalar(t.stack_depth),
                      ascalar(t.receiver),
                      ascalar(t.value),
                      ascalar(t.thread),
                      ascalar(t.caller),
                      ascalar(t.line),
                      ascalar(t.param0),
                      ascalar(t.param1),
                      ascalar(t.succ)],
                      cross)))
            as
            lp, ahashidx(dedup(select([log_bench.id], log_bench)) as k,alist(
                                                                    filter(
                                                                    k.id = log_bench.id,
                                                                    log_bench) as t,
                                                                    atuple(
                                                                    [ascalar(t.counter),
                                                                    ascalar(t.event_type),
                                                                    ascalar(t.id),
                                                                    ascalar(t.stack_depth),
                                                                    ascalar(t.receiver),
                                                                    ascalar(t.value),
                                                                    ascalar(t.thread),
                                                                    ascalar(t.caller),
                                                                    ascalar(t.line),
                                                                    ascalar(t.param0),
                                                                    ascalar(t.param1),
                                                                    ascalar(t.succ)],
                                                                    cross)),
                                                                    id_c) as lc))