filter(lp.id = id_p,
  alist(log_bench as lp,
    atuple([ascalar(lp.counter),
            ascalar(lp.event_type),
            ascalar(lp.id),
            ascalar(lp.stack_depth),
            ascalar(lp.receiver),
            ascalar(lp.value),
            ascalar(lp.thread),
            ascalar(lp.caller),
            ascalar(lp.line),
            ascalar(lp.param0),
            ascalar(lp.param1),
            ascalar(lp.succ),
            filter(lc.id = id_c,
              alist(filter(lp.counter < lc.counter && lc.counter < lp.succ,
                      log_bench as lc),
                atuple([ascalar(lc.counter),
                        ascalar(lc.event_type),
                        ascalar(lc.id),
                        ascalar(lc.stack_depth),
                        ascalar(lc.receiver),
                        ascalar(lc.value),
                        ascalar(lc.thread),
                        ascalar(lc.caller),
                        ascalar(lc.line),
                        ascalar(lc.param0),
                        ascalar(lc.param1),
                        ascalar(lc.succ)],
                        cross)))],
              cross)))