Select([lp.counter],
       Join(lp.counter < lc.counter && lc.counter < lp.succ,
            AHashIdx(Dedup(Select([log_bench.id], log_bench)),
                     k -> AList(Filter(k.id = log_bench.id, log_bench),
                                t -> ATuple([AScalar (t.counter),
                                             AScalar (t.event_type),
                                             AScalar (t.id),
                                             AScalar (t.stack_depth),
                                             AScalar (t.receiver),
                                             AScalar (t.value),
                                             AScalar (t.thread),
                                             AScalar (t.caller),
                                             AScalar (t.line),
                                             AScalar (t.param0),
                                             AScalar (t.param1),
                                             AScalar (t.succ)],
                                             Cross)), id_p:string) as lp,
            AHashIdx(Dedup(Select([log_bench.id], log_bench)),
                     k -> AList(Filter(k.id = log_bench.id, log_bench),
                                t -> ATuple([AScalar (t.counter),
                                             AScalar (t.event_type),
                                             AScalar (t.id),
                                             AScalar (t.stack_depth),
                                             AScalar (t.receiver),
                                             AScalar (t.value),
                                             AScalar (t.thread),
                                             AScalar (t.caller),
                                             AScalar (t.line),
                                             AScalar (t.param0),
                                             AScalar (t.param1),
                                             AScalar (t.succ)],
                                             Cross)), id_c:string) as lc))
