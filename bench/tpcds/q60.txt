groupby([i_item_id, sum(total_sales) as total_sales],
  [i_item_id],
  select([],
    filter(((((((exists(filter((i_item_id = i_item_id),
                          select([i_item_id],
                            filter((i_category = CATEGORY_01), item)))) &&
                (ss_item_sk = i_item_sk)) && (ss_sold_date_sk = d_date_sk))
              && (d_year = YEAR_01)) && (d_moy = MONTH_01)) &&
            (ss_addr_sk = ca_address_sk)) && (ca_gmt_offset = 5)),
      groupby([i_item_id, sum(ss_ext_sales_price) as total_sales],
        [i_item_id],
        filter(((((((exists(filter((i_item_id = i_item_id),
                              select([i_item_id],
                                filter((i_category = CATEGORY_01), item))))
                    && (ss_item_sk = i_item_sk)) &&
                   (ss_sold_date_sk = d_date_sk)) && (d_year = YEAR_01)) &&
                 (d_moy = MONTH_01)) && (ss_addr_sk = ca_address_sk)) &&
               (ca_gmt_offset = 5)),
          join(true,
            store_sales,
            join(true, date_dim, join(true, customer_address, item))))))))

