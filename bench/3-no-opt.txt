select([l_orderkey, revenue, o_orderdate, o_shippriority],
  alist(select([l_orderkey, o_orderdate, o_shippriority],
          dedup(
            depjoin(select([o_orderkey, o_orderdate, o_shippriority], orders) as s1,
              atuple([ascalar(s1.o_orderdate),
                      ascalar(s1.o_shippriority),
                      filter((l_orderkey = s1.o_orderkey), lineitem)],
                cross)))) as k0,
    select([l_orderkey, revenue, o_orderdate, o_shippriority],
      ahashidx(dedup(select([c_mktsegment as x250], dedup(customer))) as s6,
        filter((count0 > 0),
          select([count() as count0,
                  l_orderkey,
                  sum((l_extendedprice * (1 - l_discount))) as revenue,
                  o_orderdate,
                  o_shippriority],
            alist(select([o_orderdate,
                          o_shippriority,
                          l_orderkey,
                          l_extendedprice,
                          l_discount,
                          l_shipdate],
                    filter((c_mktsegment = s6.x250),
                      select([c_mktsegment,
                              o_orderdate,
                              o_shippriority,
                              l_orderkey,
                              l_extendedprice,
                              l_discount,
                              l_shipdate],
                        filter(((l_orderkey = k0.l_orderkey) &&
                               ((o_orderdate = k0.o_orderdate) &&
                               (o_shippriority = k0.o_shippriority))),
                          join((l_orderkey = o_orderkey),
                            join((c_custkey = o_custkey), customer, orders),
                            lineitem))))) as s0,
              filter(((o_orderdate < param1) && (l_shipdate > param1)),
                atuple([ascalar(s0.o_orderdate),
                        ascalar(s0.o_shippriority),
                        ascalar(s0.l_orderkey),
                        ascalar(s0.l_extendedprice),
                        ascalar(s0.l_discount),
                        ascalar(s0.l_shipdate)],
                  cross))))),
        param0))))